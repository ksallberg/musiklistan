<html>

<erl>

%-record(usercookie, {username, times=0}).
-include("common.hrl").

out(A) ->
    H = A#arg.headers,
    C = H#headers.cookie,
    case yaws_api:find_cookie_val("usersession", C) of
        [] -> {html, "You need to log in!"};
        Cookie ->
            case yaws_api:cookieval_to_opaque(Cookie) of
                {ok, OP} ->
                    Username = OP#usercookie.username,
                    Lists    = musiklistan:playlists_get(Username),
                    io:format("Lists: ~s~n", [Lists]),
%                    FLists = lists:foldl(fun(List, Acc) ->
%                                             Acc ++ ?b2l(List) ++ "<br/>"
%                                         end,
%                                         "",
%                                         Lists),
                    {html, Username ++ ", you are logged in." ++ Lists};
                {error, no_session} ->
                    {html, "Not logged in..."}
            end
    end.

</erl>

<body>
     <form method="post" action="playlists_post.yaws">
        Playlist name:
        <br/>
        <input name="playlist_name" type="text"/>
        <br/>
        <input type="submit"/>
    </form>
</body>

<a href="logout.yaws">Logga ut...</a>

</html>
